package io.iohk.prism.apollo.hashing.hmac

import io.iohk.prism.apollo.hashing.SHA384
import io.iohk.prism.apollo.hashing.internal.JsIgnore
import io.iohk.prism.apollo.hashing.internal.toBinary
import io.iohk.prism.apollo.hashing.internal.toHexString
import kotlin.test.Test
import kotlin.test.assertEquals

@JsIgnore
class HmacSHA384Tests : BaseHmacHashTests() {

    override fun hash(key: ByteArray, stringToHash: ByteArray, outputLength: Int?): String {
        val hash = SHA384().createHmac(key, outputLength)
        return hash.digest(stringToHash).toHexString()
    }

    /**
     * From:
     * - NIST test data
     * - https://tools.ietf.org/rfc/rfc4231.txt
     * - https://github.com/crypto-browserify/hash-test-vectors/blob/master/hmac.json
     * - https://github.com/xsc/pandect/blob/main/test/pandect/hmac_test.clj
     */

    @Test
    fun test_Strings() {
        assertEquals(
            "63c5daa5e651847ca897c95814ab830bededc7d25e83eef9195cd45857a37f448947858f5af50cc2b1b730ddf29671a9",
            hash("000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F202122232425262728292A2B2C2D2E2F303132333435363738393A3B3C3D3E3F404142434445464748494A4B4C4D4E4F505152535455565758595A5B5C5D5E5F606162636465666768696A6B6C6D6E6F707172737475767778797A7B7C7D7E7F", "Sample message for keylen=blocklen")
        )
        assertEquals(
            "6eb242bdbb582ca17bebfa481b1e23211464d2b7f8c20b9ff2201637b93646af5ae9ac316e98db45d9cae773675eeed0",
            hash("000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F202122232425262728292A2B2C2D2E2F", "Sample message for keylen<blocklen")
        )
        assertEquals(
            "5b664436df69b0ca22551231a3f0a3d5b4f97991713cfa84bff4d0792eff96c27dccbbb6f79b65d548b40e8564cef594",
            hash("000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F202122232425262728292A2B2C2D2E2F303132333435363738393A3B3C3D3E3F404142434445464748494A4B4C4D4E4F505152535455565758595A5B5C5D5E5F606162636465666768696A6B6C6D6E6F707172737475767778797A7B7C7D7E7F808182838485868788898A8B8C8D8E8F909192939495969798999A9B9C9D9E9FA0A1A2A3A4A5A6A7A8A9AAABACADAEAFB0B1B2B3B4B5B6B7B8B9BABBBCBDBEBFC0C1C2C3C4C5C6C7", "Sample message for keylen=blocklen")
        )
        assertEquals(
            "afd03944d84895626b0825f4ab46907f15f9dadbe4101ec682aa034c7cebc59cfaea9ea9076ede7f4af152e8b2fa9cb6",
            hash("0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b", "Hi There")
        )
        assertEquals(
            "af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e8e2240ca5e69e2c78b3239ecfab21649",
            hash("4a656665", "what do ya want for nothing?")
        )
        assertEquals(
            "d7f4727e2c0b39ae0f1e40cc96f60242d5b7801841cea6fc592c5d3e1ae50700582a96cf35e1e554995fe4e03381c237",
            hash("6b6579", "The quick brown fox jumps over the lazy dog")
        )
    }

    @Test
    fun test_Hexs() {
        assertEquals(
            "88062608d3e6ad8a0aa2ace014c8a86f0aa635d947ac9febe83ef4e55966144b2a5ab39dc13814b94e3ab6e101a34f27",
            hash("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd".toBinary())
        )
        assertEquals(
            "3e8a69b7783c25851933ab6290af6ca77a9981480850009cc5577c6e1f573b4e6801dd23c4a7d679ccf8a386c674cffb",
            hash("0102030405060708090a0b0c0d0e0f10111213141516171819", "cdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd".toBinary())
        )
        assertEquals(
            "48fddfdb6f932f923ac9a4114187231129a808f7499c267ec62e633e60bc8261d3b567d60bbb1bed95bd62d740807ef2",
            hash("4a656665", "7768617420646f2079612077616e74207768617420646f2079612077616e7420".toBinary())
        )
    }

    @Test
    fun test_Truncation() {
        assertEquals(
            "3abf34c3503b2a23a46efc619baef897",
            hash("0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c0c", "Test With Truncation", 16)
        )
    }

    @Test
    fun test_LargerThanBlockSizeKeyAndLargerThanOneBlockSizeData() {
        assertEquals(
            "4ece084485813e9088d2c63a041bc5b44f9ef1012a2b588f3cd11f05033ac4c60c2ef6ab4030fe8296248df163f44952",
            hash("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "Test Using Larger Than Block-Size Key - Hash Key First")
        )
        assertEquals(
            "6617178e941f020d351e2f254e8fd32c602420feb0b8fb9adccebb82461e99c5a678cc31e799176d3860e6110c46523e",
            hash("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa", "This is a test using a larger than block-size key and a larger than block-size data. The key needs to be hashed before being used by the HMAC algorithm.")
        )
    }

    @Test
    fun test_Seq() {
        val expectedOutput = listOf(
            "44be81c415d283ab7a62a45188e5dafbcb97da606bd5b16c92c1fc36f198c0b3a714921848d5e03df1c4849bb8310c66",
            "c1e1e68d864f758941b87e30c262348b373f167ce4629e4117fba208773ccc2e6c7797ae5d6bbe2abe6bad4de2e1052e",
            "bb27a0f06a1baed5ac4fc2267c36eab663e11ec5f0fcc0bdc09b9b0e803b0acaa2f39d2ac73de489fc7c9ad6de3fc9c5",
            "70a273a2e9e5092ef8d4c58e99734a911b7cadd48954fd518305313b0b682cfce192018d4847375d7e311470d05d97d9",
            "b4faf12b325b486b67e38a855d18b45d1bf6cc60e4d00aaa6e58268f524cc1121ad3edb64d6e0fa524f11c0f139d0bbd",
            "b509a325f561cddc539a3a4680380759747709d428b77e69c4cfe926f65b147d92d2c83692f526ebb5cf606ad162559e",
            "9a1e678a743ba285ce154adbb555cfd097f5839eeb2de4147986464c1bf032ba0d80473293467ed0a0ac59beae736598",
            "1df214529464666002c1af094bb36f0fb14a4923031b108c21825e8c55bf6a0bb34c9ad7d5030b2fc7c83a2cd4c79c1a",
            "86d8bee44cac35cd3946321796599f20f3a41be28f161fda062e4440ccc16e88bc7ffc714d525a6420cdbebdf6ae9e12",
            "92417595f9974b44bb11eb9200b7560fea3382cdcb8ba4c2cc5cfdd019c2b5956d3e78d5b186633acb765e822b3d4e90",
            "2e87cf886036b7a66ae6581ba0dbb9ac2a39e1c7c7594319184ff3b612a165dc02b3a7133e3ab3d29634b1cd5305a46c",
            "a5cedd2b54657832f946bfba14ed5106e8eb5937eac6c5405be5cbe7c58053514e784e3f6668c20466a242d25a44462d",
            "74475d913659c2c304ba49dd2b39b0c7ad7d537bb2240d8611876cf5955b347694525396c43ca73951e711da38c6976a",
            "b0aee82d70411f1a79dd7012421bac1202d7c3baffa15b4d8b868a3e6f92b513f6b026e2e8fee45db2ae70c15e11d19f",
            "7d06ea64ff5b9139662fcf9318589e8ff1f783754a9116e090b0b7a981a9ef1d4c1bf582c8ef5e71a49dea2834447287",
            "8f52bb9b0a2b1066ab67603c552c17e983d15114c3b9776c548d747f7e24ac782253812802ec456914444dd67c0cdd46",
            "9de6587211fe4a232f01d6d20554102d24d98ec140a05303c1893f232baa2c07c81a10c25a95a50b38e87898900bbe1f",
            "e0175eb9db2649801ec2eea9de2c1e950c129ca249c14326614e0bb8c32aee67df1dfc6320439dae4fcdb4b037a53868",
            "0606a848086dda50d031a585103478eed0259a9167959657050f8d7dd21b4d6b62b93aeb0009b1e878edadefae9b2adb",
            "d4a45dd1a6b613e3d2d72b35e6030e1531d75af7c3f100934cf27ee9d0e0f0c236581ec8ee74ff759d7a19c5aa6da9e9",
            "3e0fd11ae4933665ef30e10035b0e686dca837f6d6fe2d5a10b4ec30f183eddf3558309905f028db93323d09a3a2f3e9",
            "da2a204c7908fd27a29415cae3bd16a0488fa1d42ccfa2e2f5a1efd6f99583ec6b3b36762060f547c629b9a332585355",
            "ffe8ffed47933cc941a8e9233c037080b9465b4f9c25dbac790825c013545d2344930e953187c77466437be226962f80",
            "69fe734d5c69f34366e5ca6b095de91cd4dea29ad70bef06afe9bb232162e6bbb1349263087212ae3ae5d74a3b060f50",
            "efcf1b825af87fa5199fb3c76783ccd1769e7dc77bcf145db76fdc622bfa2425cffaa40e6376086b2dbf6f5d9d97a534",
            "98c3dc50fc08d2a87abe3fc16871ecb820d530b453c41f83fd304d51660fd29bec6a7d1c63e3e12b6e80e8c58cb129cc",
            "945047cd723ef4f25aaac4a19fdeed463eb04ccb78ea318989143298dfa70d793391bb7fcea6be0d79187543426aadfc",
            "2718d89f835037c94cd6378a3806614b85365a888b48ffd08c09f0b93360c04e43b7e7a19c79bcdc5db9f5944579ab79",
            "f714f16238075796dd43960e17ae0edf9990132d690f44957c3de9eec2773683172fdcc44ed2104320726baa7dbda1a7",
            "a87a96ed8ff0e7fd1f235f070cb5f14b41b2c4438a6d7a0a39d038c74008fe9c52497cc506498414835aea1192439379",
            "31b029dfa85df545b752506e80675e617549a6725a658ca8123d8c837fb71d8c9961bbc2460d7cce0cabbdedacb56c37",
            "0b1a9dd308e5e6e65e4c60861d42b628fbdb2c2280370effab736a77a8004c5acd5269d090b652b1d8f146c1d518d288",
            "2a160e0b2ec7bc927fff813a2b56ae61301aa14933c659b3398c7a0b3ca506dd00fa6f1de9c6d47ab0fb2bf2e7b4b83f",
            "6893c0205f3f4ace906f2facc97e2b1624d40997370419e5981e6041d5cf34c77ef5abdb1aa0d3c8c3740100c2711555",
            "95bc8c72dc8c70adb7cd38311292adeb9d7bdec6a9580ef4e11a18317cb65667d344d8d6603c044454e67f97f4ddff40",
            "3dd892a4e724376814dd5a4cbe96e4317aa8af72478d53379247e77c35461bb92cf493851ff1fcf57a6704923099dfee",
            "3a5deaf967bfa3eeca3f259307991f7dbfcec1f354df385cf0ee8d93291721553ea954e9d6593506e9f3e330e0a02574",
            "e00a883dcb5460aad611603614c7214ec4a566e0580fcab1ca4ecf1386a42dcda746d3ae1b0d54e0b9ac1fa336fe787b",
            "f437cdea425e7a70cb4d197c0ca01562532a7c51ffb8462b4796a4fd0a7ec880cb0e5eddd5f703adc179374416592256",
            "ce69e40f5b5f2f25e0b53281be76ecb0e5b4558292a1c1a5ec56f2cf11b01beeb1f0ba01e6a9b3d03beb69ae0511f320",
            "41aa84d15342cd0675c8c0312c024352e99914c3e01c98f969ad04cb5705e9184f3821cfc6a22d43a77c928f6db79d8d",
            "74001d972353bb45ff3f7f405fc727cb5d0b00431bc76a57eaf17862bd52949af884403ed6b2a002d618ea33523de200",
            "968bc28223799f1eb92f1432b6aaf5cf6953491c3f959977b065bdb800aa438cc8aa7ee1304c18999cb5ed709431cffe",
            "d067ec03f14d2d639c4423a311ec86b3ddc3693a2cf43c259bd0358f8d0d68f41950cb705249a59072a2ce7df155f5c0",
            "f41eb77179934884ddb56dcf83dc90c606d0226ddf94135ff8e1e0aa56c9a90881c4c380cc0ad3bd0da45a6352bacc05",
            "27bf9a98f9e2732972fe2f35abc80ae2e5a2bc1d238b9b1d9ce605a89144ee9766987384ebdcd63533e64bee094e4503",
            "166892e106bbd9d16819d9bdd3601d24c0c11860db13799f0797f204d07dbe914a7bd286b380efac34dfe3c940cdd3be",
            "2d85dbcfc431a94f8f50132dc8c10b25001ea10aa9df7c53aee9e8383eaadfcecc21202efbca556bb4e33cc68156b190",
            "086007e2874e779a5edf0e176ac1a11d241f4ad8d02aa99df2bc1ae3e5cc4775aaa92adfe772ceee89d4fdf1b601d05a",
            "2eca3144f4f9ea0f37c2ca5943f458590a1d4d19c0ecea6a55cdca648c99cd457dc57eaa995042d7fbfab598b8afeedf",
            "9c1f31f5d3a589631d8b7ef89a507011736bfc328071513d64e5432d24b1bcf47eb10139b6410a3103145af67b5b6c46",
            "e0645eda004d9005399a2c072ed9959e4f8905d15c57992553202a3b53bcfea0098e6b28be047a4b29eed7b57602c0e3",
            "6ce5ca92f0b1e84d7578ddb86c96a10924601a3680bafee5a0b27d8390b59752205ea483832ed3e9343de7175601c03a",
            "47f50844c897fd910c5c228dea1eaf456882c1115ab71db15e6832d96607cb79c8b7ad1cdde01966fcddaa0b0ba9f264",
            "c0a7efa24590833e4788bb117d3ab3ce00c84cb4820ad9fd7f03cf1ce1a8983f9906bdd138e1943d75ecd9b98d5ad8d3",
            "d056e9f831b6dbe97fc751453b1c52c8c6c4d18a00050f5af2427c1123706375a918656d6755a4c950f4e5b5c318cebc",
            "462650ce3981edd13d0fd2e5fdea93a9a18cf8fa74cd6142df4707e604d1f72745d7ee08ab13aff3a9f8d166ea90ce3e",
            "2ba5249841412584b161063087af9f5baeefd97989bf8a0455e65c94b0663410f0e1bb22ea6402e59cbc5a23f24abbfd",
            "c3b1e4b05a7593cc315ae15f63ce8d91c4b30e0d846a97b7d8f01faa1b6bd7c9234eb153372f6cc7799a035e22a77ef6",
            "1e652653b9a3ce862dbbaf2c919e86891c5c03f54ed5970e8028f8d5efb533b9c111dfd88acbbde516f0d4d636f5e821",
            "da773d5aac336b6266d27a03afdf3a151fab302e894cc1d09b6e4ecd07c4af4be06a2d28d01669c7557fae8e513d01d5",
            "8c8fe648a29d4ba78b3e0b944597e392a31e28f98b15280e1ec0a721c9ed5e3639a6a457744cc5aabfb3600501f5054d",
            "b443decf40a5693f67b5bf5580a665df6eb98fa9f14a661cd50d6635e0f78fb2943731af363839fe6dfc0b4c49f9e849",
            "b22ec4afee3ea69364701e5621e453a0c3988c1e2fda54fdb99353f285327a534f7162bc54d701652744413b9a5d4cbb",
            "40a22b7881ae8139941540540fb37c9af27bcb164b6d1a3bec709730bbbb413d1f2fd6ba4a7b7ea747ff45f3ed3336c3",
            "246e426c57e414575df312223272819b0f49ff94953dcb94665fff74feab049af15160706ac5f702af66478cf2bba5bd",
            "184e6e6d5fb55454eeb6dbe323bf28db8ce60c271dd0ecc8bd4d3f1c2339b7828c1515f030058ff37bd53568fea81378",
            "10b23fe1616ad5609f6f6c1d9266f702c1b5e6f7fa0b3a81406b5a766e2179d082854687701318a7b46e21fa67d2404f",
            "dfcc1280c5206f99a555e291aa1de6f0a3ae4b49916feed4337582b91d7ef094159556b01ac87bf7a8e84f9f53595938",
            "91ba9a641616449084a57221647369e2e69525a30b274ee5403fe95a43d0a7c2b301b61929d89222a3a03303550521b4",
            "94f59a7f5e68b942a5d66d3c642a78685f3bb400f4ff971ba576dece94a353455277632b70d06eae38329cc2298ed792",
            "21a9f5c4b1290d95a1f3f051a0158f7dd8a879e7861b61cc757fb5c729fe9a8bd46bc6dce595d20649092b31ad27433d",
            "e4246f7de67c3a08f18852f6159f5dc9fa4c0129a9f894eb610c10f1fb8b61b1c9947d742a418f03a00a7e11adf436f3",
            "8d2ce8209b8362311d99d68dc2aae6be4cc8e52c03a97d99d0c5c15d8e24f1d3b51738bd27beb6e773472cd22a1225c6",
            "7eaab124a3c900f33de06b84e7831fe327fd638c4e68dc8648eb619e3c7e5736a26bcdcfd3aa6af34eb137c6a210746a",
            "8b60f61a1ac2c6528c8db07b6874f19b8d474859f98af03503b115eeb8082e19d53f63d397647bc2d4278b8c2b741d19",
            "a48d92ba646daff7d0f8cbcb1d574e9c19d396a30573a7404f6196fbd7e226731c8ab05138f7b1936986de6c1f1f7b52",
            "2c3ecca6e7af0f9587e5a03d462c98f18b8c13c039d02d2d29e06b5309edc82052ef72c94e0a5eb7fd35827665ca2f92",
            "c9b659afaaeaa8778e9e4e3b725f758768963c55151a54bd9dc191e1302aba1f1f085d5443c46441793682a8047211e1",
            "9a76e83a301c14ac6ab8cfb29d2ce39e0e86b335f2b20c3c889651b4e0b94c5218e910b1dad28474251d06d12d47072a",
            "a526cfaa2ee981a9a4d0ef12a6fa363f562057bb75a218f4645bc5e9be7cfe7eadfd87386aae1c607d812772498abbf6",
            "b747819b54cdfeaa751fb9f5c22fb269151028bfbc6650bc518692944c5f4195d26aec45c9b4c987ecf4076b3871c5cf",
            "d45968d452b5349ca43a0fdefe4a5379381625825a27259ad9bf5a80c46cb07bf1c919fb3acc250d73238b11c3a07d90",
            "c0b8ab0f8c497ed9562c65091df1d80c32c57a018b00957bf53c41df81a2f6371fcfe82624b2e84859114152b36b6aad",
            "30d2bf3da80c0f37807f042fe7b878851e0bc4093d987438fc2b993f4cc4af6f704669938b9e30e59bf8999883639f64",
            "bb782acee42930922a98f65f319089e9b4f5d2dd2374dd76035e3178db4468a3c04f5ef878ecf9ed757df14dd89bdd49",
            "157424f30a10748940bbfafb6d99b1b06a897e7daa4f03387e5ed03f02d39af59f96a20e4e9f3a4c5c07c20a8fadc8d0",
            "b9aded711b1e1537a35af882f1f868d964b5898e85b07f5677dbf183232f36c14af4d9959c2108d9313f8bfb14830b02",
            "7c4563bac3c05444c3682039eaf9f9ec79b96f0cd36245f584647bc444b81734d7ed4380cc1f0a2ba876020e55660be0",
            "9811a4a45cb28a780c063047ec6cf94328102deed9971db99e11c6fbcfc046ee38c1a00f290ff64356b9a304dc0f340f",
            "09a69d3255eb08e9b3cf7cfa73d86944ccc91deeefc04214f8982836726caf006a3fd83f8fb75600cbd060ecd639c388",
            "52d6d0943728cd2eed671736b6b3be801b811410992e4a3bb50ab4269eb21ab945f6a9f7036da654a7f2785869335395",
            "8c0e1052ef2b06c0c20f67d92e51dfbadf3655fc6475935426ae1c88f3096628eab9858e5470fb98a546eb11c7b752dd",
            "b21351af8400b9756f104599ba4bb78c2904959e2b24ac3e15fd0398627e6c8d57a7f9feed63d8638a206bc1683794a3",
            "b9f7cfe97c79568d62b07f1ef887c4391b48caa669aa8495b71a326b120fa49652f02ec0d53441daba1e104af091e0e4",
            "69d2d1773208ce3bf02b38a7f14910187f3476817adcc7a1d9830c9f25f112e604aebb95d0237ac8795dcb23ecf52927",
            "57a9fa7ca61fa2fdbf0bc3e3e6463901b3b26e5d9ad79dfc0cc77f79ef3aa1ae3949e7d71cf794e067d2e38e7038edec",
            "fee9196a0a1199da8697d00ac8084d6ca1f867d105ee928ffee14e5e36bebede5c79509ca5ba05e36c3f0bafdc9a755b",
            "0e8daf8ba4ed614b38808b4e468cdf88ec9b148017c6be3fe593410d37d9b50adf0913b7844ffdcc2f1917a27a58b352",
            "c7fd40463e26d6a21373eae14bcb7403b127a1e23e4583b2ac727106b07b849f74c0907804aa799c05d9ff324d04b182",
            "16e899f4850512ff3db0fcc58fea960831364e5fb077cd8da3f5b3f0f50ac626601917e8355e4847a00e0a5166e786d8",
            "af2dadb17605db3cc471c00d63c42f75f815594c1b49d9396bcfe7ed4d4fbb1cf15b542675de8c9ff50ef81b72ff72ce",
            "1699a1ea2cac707205a6bfad8dfdaf09c8d6fcddf2bc14a9678453463ac80054627f2c39b713861734b0974f442d707d",
            "186da71d7e913da49d8d97101882b1282841d41ca12f514c1b2dd61543e330b751e9f97490e18a4a37ff1853efdd757e",
            "d82050038e6df6eae9d2d4019827025a25bc8cb15812e0acf4b676c799a3d80acae5706c0fb1ff72b2c4851dc9232b7c",
            "1657c99506ec8b28afc1684c4a9ee4970f8f426e4bb0c3fc2795cfba82913b453c87d84ae9b32897a4ce26ff4320cf23",
            "9834e936482592bac2373aa64806fe0d5c8fa92143070c61e594004f0d3b8516c2a5b0244f273124e83b20fe9a2cf5d3",
            "5c4856a82c8e6e49bb81e89c26e355afb75ef921e579ec4b97868be2cfb4b1d93195aba0500d774c5365c2269ff333a7",
            "67b88fad5085c8bab8e194df73153a5b1d334431227dfc619d5ca5d5605edc7bc95de33512b2f5b714f46f54e1e61b0a",
            "90c6a8f36d42c5f21a89417aa04d822a53110df1d062e0c1a6fd9ae59c6588cc1c78469b94578b6d7c05effaf7fec26a",
            "817c0e7acd548bd3733792f4f8d845d7e4b3caa0f0ea943b51235eb82da7c8b77a733d756e86d57ea303f34bd97ba1ce",
            "7ff397fb43dd909ab80bc381eaa4bd50b7278dbf10f39fe718b421d6c07324f398ba5b1dbaac64137267de2c62f19f7f",
            "fac12b732122e18dfbcf8dc7382ab1b55353134f07e07723608825c907db05b4fde40fe550878d971f8b0b0953c88c54",
            "4db0fa3c105d64a9cae84c0b5d7af0955f6f58717f68366935ff9f478e94d3969b1264b1f37f8f5538bf116de29438ae",
            "ba6e693a6c3c5b048fb7f232cc5e12ca71662332ebf689ad75f6f2c54715a689cb1f75525313fb8b2713909ec13ee0d3",
            "00ba656bea25dba36861b92b356c3dee0db1c86d4503c7feb0a88a3541a7018ea456c95224efc46aa31cb625421bc811",
            "812622078ca3b4f59141569a0e125b36f7cc471f76b7b65feaa1f1f656bab6a3cd61a4d2456e2f5109274b2090c1f4cb",
            "dbdad8926a811dd0295c31d55ae0d41672c7f22b5caeabfda2c1505b084ad01440e9b8ffda4dfcfbe281222afd547e29",
            "a32ebc13d689b31617d24e6ac03ce6fd7b1aaa2ba78cae2e24c36a8ca7bc74ed9bd4cf6c74e3c96deff048fe3964f0a0",
            "095d2c8dcf88f69da4cc49c64b03b2a1d2c6922ce0c6eda12642480ae0df35152b4e4a9ab08d6642ddc313c0fa01444c",
            "578a4bfc0ca83f1b38a0d2eabe2c7d3d67436b559624b92e4fbd9241b2ca8c1ab679b503a754d5029314aac3af225f38",
            "25e321e63e4ac8994fa464b3e2b687150007d83ed8d6e1b217e86b0ca0d163b0b9686e4fa2f26c1839f2d778edced86d",
            "c761ba17fac3cccaf2cace92283dc5e5b8a6571958fc59d0070fb21cabc88a80a40dcd56318988f3aedf38aefbb84eb2",
            "5edf5d71d2cf85e7adf9c7e964fd628acf304c4de3483f672666a583e3d9b1d86e9e096541ada237d69a140571f5b3b9",
            "401702cd847eca2bc9208f52f27d84d07b37a86cca5c3a877f24366cdb9719de63670e850f02cd02c6227b7214d5dda7",
            "362c899156df70fa189a66dab6dbb3cbf80b629d1e90d9abeb007c3c5010277ea589c4d73009c81f94aff3ffacbfcb1f",
            "ca43387c71b8245b822d3085cf029004e18cebdfc9f78c276f3559d962635601957b6d2287089ad43f3179d077f37686",
            "4ce8504297e21812c901e77c6680529103a017553f095913cff06af20e3d6de7efe911b636dcb5791b292c60147f6473",
            "2ac71958c77e39d4de4dace92fbb6a093eabd191320a5ada7114bd201dd026567d2b799eac78c1f084ba9faec2fc8bd4",
            "87487060c273fe18a2cf1dff222658e1b50c3bc5a3f1f4575b3a4a6ea2f42238deb68b3a2ec6a325e3fca504b2e20e26",
            "4a79a1c3c798d9f26d54715108279948eab246086ebfdf0eac9152216c0ba3a77aadf82a230aa84a7c884063960419aa",
            "db0ba43960fa6b763202b8bdf3fe4ada0bad78ebb3e6e8e57c2d5640d1ed4cfb4ac18adb1b9770db49a4252cdd25a369",
            "eece296e258ea3583fbcad1cdf2b91f4d2ad1fcc1aa339d8f591f89c7ecb5ea2fa644954006f0a58f2f3beea1aeaf7f8",
            "7afd95c86517bb6050d04bf3bb1448a0608411b612a7c2a939bb44b984e361c40569e5e57ad7dacb018689c2b8e2b3a7",
            "7fce7894c8e8d1fb187cc35cf5758269e286427a63a522f4bc45f814b316c1daef981917642c50ec693f3ef4db8e66e3",
            "f67f56c98221892f64e2ae4325ccb80c2846a43e1629d40bb50845184e9c3b66480b3e9f792389983f2fc48fd2508f09",
            "1cd915561856936afcc75530dff151f49a34d0dd0030766fbc1be47d611f10502be86c97b91d0e8767d4f38913eedc1a",
            "80d9cc8b1b2b883c4735b3c0c19aedab78a0771753ebb4688a7e584be7366b3c181c8532fb3a8bfc484c9cb0bbc1b4f1",
            "8ade2b8527c994eab0807a89cabd5b075cacfef42381da3cc3d702316842e25151c65a22e80885e5cd5fb5870fce501c",
            "2b403f2188d086327c92169871fd5a7b432d2eb999ffb0f2369b2b766e799afdc1463cf4d9941f828fe42591d6b966ee",
            "4a0c18cecc0641c28c4136d42fabd0bc27fec27c2587fe8a57ce0d279adad70f80c1e812e01b26f2bf3ecdc7673c349b",
            "8906762b63651dd5948c98dbb1b39bd6095c1438b2e4ca4b5a581d451ad3ef76c8a0fadec9c0b0036a833d8f5c13f1c3",
            "a363bf2a479f67f949afc151c36b052062cc2ce840974be2f5e79c0bfd7ba29008a6bfdb55b46527d17f61531c953081",
            "4e2ac5d6ee56567902cc1e02f119e33974762c03885eb7dff7c58ade22e56bc384fe74bd491efdb2e6cf4021e3016e81",
            "bdf0afdf17f7b014a61ece257f8c7e0b52384eb7def60ade785f273851d645e5d3b4d9534c0e6097a12c3cff5c11d42a",
            "0cdc61ff0b3d8510c319020b82c1c5aa12c7b6f257d7d4f118a5ec3cce03c63ffd38710f8a3c621dd8d66d8bf3790b63",
            "19e35e1e785c7a41c523f88cdcd919edc45f63783330d9033768546cf59d10aebc77f013057c0e41d6fd0fe77dbf914d",
            "8afa5df52f6581794ff014a2e1abcb05781c7f44ae6f37112b363ab13ff01fe1e8074f14466a365374c29feb048c5b9e",
            "bc9ecd12706be5adba04dce84ad53ae1b324f99c1f5937774dfe19c5eb4d6a20982e97b8f8e4e02eed13b25b8b13e64b",
            "8d02a1e318da1ebfd1cddbb7280f3603af3afa21b3d4e0727c7cfc576f55640b7a978b179eecdb8fbe896ad38e82f12b",
            "196929cf0849022cce9cbe4eb2daf6e5d8014c5a25e119eff799a82053035bfdb8b05f6c125b1dbdd4e7b393c684fb5d",
            "58808d04067fad72bbeee4f6a355e80a2ff76edbb5366ca43ff358a842fbfa2f9e1af5ff266bd2e2dab1d286af5bbf92",
            "4a548031093aba730d8d99a2c1c6ec2a986a94167cf8c1ebe83d52b34bc2068a4c95665988fa93f5246d0fbacdf85fe2",
            "ed949965036f16a0b5856ea4cf69ceda35c653bb56fd0f0b397e73ff4884b3e679eccb19b07d6a93504e82a1613cb87c",
            "dba644b20b01e4ac5cd0a325cb063eef53ad77e5a9e7095c1be0eb0e6b7cfe60bf25f38cd57f2ac055d327eb6aecc7d6",
            "cefd6165f70d9019866374ad7af9c73f3041b932d61a41734e39ae8aa9c7a4fbf1dcbae9b2a4e979c64352e3cd4e1b95",
            "732c3b457f78ded89390bc461380760fbef3cfcb9bf42a6c86ecf120c821cac79d4d51c71a955309e33724742fe2fa0d",
            "54803568bae2db4f143c78ff53b85e6a9d42ec3894fcfb39bed8ee611b36bbcbed834d366a1f797b626dff3d83ce963c",
            "35a1858e567fc8a11b92737e369069b12502ed3f44db50434506f2e540fe643655cbf806c06f15cf2428fb408a65c04b",
            "d1f9e930418d10043d0e83096cf717b79c1c9234c741c59436f42737ac73bd39b3f4b6d6439375e0d44260131b25fde9",
            "d5b56a1a70c47a3f88c519668097b54c989e119ee9dd5b8b34f0dbc092fe7108c9d396cfc62c9322563ee72a0e324010",
            "1578bb76f87db309a5d3a2229a2b346de39adb623836ef0561348aca7e315c16c6e31328bc70dd0b0d7d9b7ece076ce6",
            "f8df4c71f3623ed00edf8efc4e0ec154644e21e78b06c9c5acb980480732e17e92acfa059bdf299bb6c8351c6cc6aff2",
            "090dce25595d7770753b78c410f10e830140b23d779e0f52fc451582cde7511a390450f8b65d7bda77a18cd95ee3dd38",
            "5d3a56d23bef1324b1eae33b8255f904f7ddf131517200a505031d41a2ec3f2ab03912deff6bcecbfedcb8b948cdaca2",
            "ef712ac1e6859f70d0d2cace7aee120a666df9f210512f5c94aa7fb388f1ddd913a12ff92ccd2537675eaec870203411",
            "a0e6443505b193d89595a51bcbd47a46e1b5aeb239d68b8b18a119e5c9ea1eb8863b373f91b9f22fa944c29365406a79",
            "d97dacbf80bcc76335c187da29ff33f6d35ea8a8925709322ef3c0f6fe35d128d9d423f911ee31f1c38e1df36046e507",
            "67ffcf0a9f88f84b3ee85000b2de0b7dc12a06160fcbbb57ba291dc04e14b6dbb3cdb81a40c2ee1859956dad097c1ee1",
            "7ae82196b46de3e6948d7fbc7383a6f080903d6be6e357700a87f82a964581d375006de35169446b447537b4f11c5702",
            "502e0a4cf125ec0640dc7e7264d9e47300814b00d4322f2f62bc1d5f1d0d77173b0e7c2874cd59fd8e056b8f38f78d99",
            "74fdbc4532534dbf24230ed5677a920b12e328e3d073364498d80f0ceafbec774eb53f28f0934f787c56ab794b60be31",
            "3c9bf5eec652f40aa0ecb82a834c836e495e841d337e1299aafc067a2049c540aabe92caeae02f099bc4d3a383d541b5",
            "105ac61f2d4e586e376524c488c33521c4d49d1f95b752d27f49acd7181e8fbbca2e0f0b543efc0cbd32a5eed2cc08a2",
            "5ca49d8b554d70b3fc467604661df8fa51d9987f2a77b13de44d7809fe2956d21485b36f1d17b59f2261b1b40553fbe3",
            "1dd075c696db9b07510a0d276f8bad12225e00515d19e3b85583bf97cf82b5fe3f685502f64d91f4feee1848bcd0502b",
            "11a018c4b213bc67c09370c8a3d0b720428be71c01c6ee9ef6c9c9da8b2e1fbaeee42fa44ee54d0f526dcdcd3c2bb2fd",
            "e188ec519c6e0b8a89de68a7648dac6d9f84fdaa678b431794eb4bfe077901c95fae25ca3d39d48ea0292f3f6c35ff73",
            "fabee0b0a02ba622931a5eb82cd63656b47a20d3c0e703d5a69afdb92c0a7ec5cf6944d9d7a141c1255d60ff9532b089",
            "3c8e0bb55e099ca9f6e436bb3ca39d511ab9ce5674469df8bea4a20193084af8561d5130fdffbe62193a712d7c2d4b48",
            "914be8f0a58082b877af0dc077ed146ccd8245339a170b4099b146476b0a580749d01f83fb52834a033a3822d12041b9",
            "a1b31ecbf451571437de10330a6e9ab4484576aadc4dee0b31d9c3afe59fc6de028275126d7882a2c225edfe491305e4",
            "e4dd2e805a5bde3dcd329ed9d35caec2d5a97082966186118dc46bca7aeb1ef52e0c6007ca28131790838dd8c00e96fb",
            "785b81a972dfc6a4982e0bb76f90f26dbb7bcd2d06e872304ccf6ab2d639cad85fb29124ace411ea4742468a6663eb2a",
            "eec3cbb5aa129c7206a32a176482c9ba24fe60e71b46f7c3c11fef8eb57682a3732680e6541d5878cd6a715a48d75f12",
            "254e279b7c4f17b911712bf7138e2c6933815bab18661cb47388feebdccdfffb6ae8b4b88072b90074704eb7ec567843",
            "9a8cc3ff0d9637220cf2b4afc9a8a6cba4d0abea6a0baebf151380848e92dfed8c0f0e57b6d05095eeab0a58dfbaed13",
            "349966e1d59bc9b32e1bedb050354177868fc07257a3a1800f0e711ad00ae388746db1e4591e3abbad8f418e1ae627dd",
            "84ed950be54768557475e6b1a256c30f444e12340c29485832439bbb9cbd219050d184624d6282728d4afbb98ce4bcd6",
            "2a7ca4ef1a9356e853329d336b6e7e033f2ca13677bea67ca669eb7c78dbdde67f9e7d9099c68f34e07b96de4155aff2",
            "7c7020b0528f1b3f76ba258836a89bd27429110f0ab730fd741fe9ea2714af827e71b731afd53a293328788292acfe23",
            "91400abc089f8888dcb22880b87a380fefdaf81f237d424f057e5c4c8e3c8ee4e423930c1d3d9e16199ed82996be4232",
            "412979e13b3d143270bb41febc12196b981e99bfd6687b780812f409c78a5e2db7ae828994b60d26ca4a1f7a3a44c64b",
            "02bdd417852d9b03a37338549dfb6d765ec4cfe4c2385002848ba4d46f88053fad2a39dff615ecfae0d41f02e5877251",
            "77845ba2210971e362dc117b1bb13d7dfba62f81eeec7068d3cb9cd093df535448cc357adbf0c2394351efb07c3e7de7",
            "0f43aa1739359c14bc5702322f193af89335887f9175289933b2bb3f00a777d1d1da74f5d45fc43aa90c9ffbb0cd580e",
            "d1d9a7b995b9bff09252566d2079121ab12b0a5ed06014994464fa1aa18cb1bd8e7d5e07e1c71e2eed9cf081a537f28b",
            "67dffe8a168b7408b7ddbd10bdf14f4f2244fc904dec5850f5d8302fe35ad1752bad2de50449f9c12182a2aab8fbc9f6",
            "030b5e833f6d8703bd0c5e36354387af833f466ac812d4e1fab6cdcd3146ffe3b0e56722d671fb85eab22ca5cb0309bb",
            "cb992b3785e51ef3a32de88073586db045f356f18a09329e82943e29a12b2d1490b386d8cebf7d90fb492966989a73be",
            "a1d337d363a0bd8a0f2342351519c62318a120faf88f9b90330845da682261c64627b67d2f533fc48d2be394df8f4f61",
            "319df6326160c7277a3d3c65995bfb729a69b71b40c149db1241c0b2376b4205837b5770805c86104677917ee5e5912c",
            "ebabe3bcad828a9a3d5ee05c5eba9605a67e1ace73ae69f20bf435c3a14ac63e43b61021cdf3fc2245a14fc14a7ab32b",
            "1723d844c0558d58eb3eee3286c48c133c5f6c1d8ca512f2baf1fad7884d4fd5c3000a6756dd1e34e83dd066ad2bebe2",
            "b048bed188bffb8ff1b14caa0bace82605aeb1c666283fb7a6fdf216742f9f64a89c50b9852b8119b5faefe64615c241",
            "7fc6e8633cb9b16f553eca3c75c0c0f7b610010853efc94ac330d36977ea8722b970dc264d5fc4d69f39105e7aa0ee3c",
            "bbc6f0e0158b6dd549c5bade0fdfe415747f1fa2d2a85cc9db758f34998fbc8c8d99d573cd948ec768540b363d67c4f0",
            "5073fa9e162be773af5ba1ce5e6fc21f2f0f902c80f09bbc3aecaa6cb1867dae4dc011d1db987642949e8095909cb984",
            "a641bb0e1d20d5db0c5cb33d35b73ed83216f2f5ddd5234a0baa3b209a39e015b7245c40f9f372e618ec73450487b54c",
            "948806b7335edcc7c4bbe751844df5717457b223c7a3b81b57ab3a949d0a726baacfba228bf6c2cf94e942f9b2f1a7aa",
            "0451cd5eea206d50a7897f495d648425ca333158c126c4dba44adc06447a51d3c7bf2d4d81779535cae29792c7fe5650",
            "b4227fee0a32009d60c9c30033c12b7143d4c7a1c25f39f3e4a076bc4943992ad299deb2c15e27df867bf948da27c009",
            "daaea18fa433cf3e117f2d43303139d3f1d8c3bb8ae8efb30b44b9d5d4bd4e553b9b6eb9019cc4e1ae5d0dbb6c23a102",
            "4434c818bccfd92189a3a466d2757ae2655bf0d6cd954706c85220a33b95b184eb560ff3cddcc4df557e427e60f9fbfc",
            "6aa3b44fa507b6d704a66b4d7f26cbaab2b400c6be0a8b61b50ee617a16c2c09cb36e72fc309c6e4db24961b1785ce3b",
            "63ae9c02b96b4bc456fe5cb9ba35366dd69e78dc9ceec376c6780703883d609333d45ca577a982a177515674b975b658",
            "3b5dd4ccbe8cdf32009ce29fee4f6ec7ccb1471a3f8e9bc9a35e8cc37f6c56957b757da4c3204f9014977b93f9e30dcb",
            "04a6528cde6bb9f425132ccd4aea1ec6cea482249e5f3782b000fb071a4eb2434597a7fce2a364a9bc9e0643a8403ddd",
            "69275ca1f9f102925165a568c1f152d25df8820a6f34595c4359159070052fed260c55fffaea2116aee7a63ddbaa0160",
            "584697c23c63904709bea89f055ac592df48034f908c9f06c706a51c3f6be5f0f2a5b953ac2119fbc0855b785326c06d",
            "04221f0a6c4799f9cea3c1d9e65b9f77f77c613fd114135db019d8c497b8899513aa4b499e720cc11aecadd1ac071dbc",
            "c7b878613c2f2ed10c8ea413970b124838f11f0414aec89a3825ddc588629a8049e82b461a23f25c4f93e5bd11c184ac",
            "1891e7a51768e05bb1d03a1ec1b844c7c8ef77c433f700175998b2d8e2eeeec4618f00003793c5873655e093048b674e",
            "add2b81466bc727ac85dbe258b566c4db56f6f7d81d7a4e43f86c125f2ab2e08c648e628b9cfe440f8bc06fd5d861d3c",
            "b3684beba86d275745ceaf0922473ca581ceb7371c5747eb87b407468006ba50d69f9bd8bb7f214185cd0d0c548c5432",
            "0c783882fc826917619c07fd03ffc46de6cd87bdfa87f1fb872989489c32fe74e8c5660748e1e8e9ae19c68b075b0eba",
            "df52553b4f7bd148574bb47f61bf8f7b2fdbe5b6963e29cd559f236baafc3dfd6a7eb5ec9968e0c2b3a453f982f16aac",
            "45102671440b04027b1f9966c1013aa351caa3f3cf42c4d98f5b2d030ff37836e9f5865421d7dc8b037644fe53c6b280",
            "247396bf60c0fba27b245cfca061d1f6ec50cb87cee54e8c4a7186a07745d255e4ef9457c0a329ac9e3fc913df86a4ca",
            "acc5998c464a26c1719e9b17e1b8f5e3657ff0364c46fe87154dcd1c95a84734214d2b81cea8ddba501975281ef4ea9d",
            "163f5ae385500c1a6ea212d6925e48ce2189db1dd47f7f2d2d889272d17449a1c33eb3970a5982ef2fe5f1255367c33e",
            "e8bbff2c5cda88cb60beadb8d04b88795b0ccd89057ceff1ff588a169363ad453564fe7528d1fb7148845363c3e17824",
            "5f8671b7c62a5ee9717ff80ec2aa0a03e557a2840c0fd0b59027afc834c051cc9b7beffdee3478165db9ca303e2d874c",
            "e0e4de22993e4a6b4884163c678a23ad6349dcd4c16b9041d01f8b3fab1e8d8b07da78bfeb57f8c235c173b2d238c4b7",
            "ad6f58bfa15fd0df1191171f86f2b4c8729fe407128adb4fac3404e15c04752f2a4b5f4bdd488378c56ff8d85a38e583",
            "90c5a75642a1811d8fc1ecb84af4904c6d9e613353c1b9ed0fca37d20974cc2425052e2300738824becfdb981aff06fd",
            "ef73a9e6d23ce43508400163ce6f3e8f7076cefb94e549eb6116c2557f740d66a1727ad51ca645a7f9022912058fd262",
            "99fa424e413a57db2b1b851098fab1b6d3337ac7fa85709121f0bbdafb3ee291f44092ea7eb28e9bf0ea0691aa531bfc",
            "a1e0a088a279e750cec429d0ae320b638ecbf9ee387c65c66d2231c884d844dcd438d4d4e052b8d76998a444e0666629",
            "0657fba0e7a73f7525505235120c44aac6d37ce974ff23f52872d6ada50da022d417d8dae40e80336846e8ce211d5ac5",
            "a72ed7917f0f9d0dd888dab10af9091a380f518d5dafc005d1ebf0013f57a7452aeba98913f509509a02665f332ee255",
            "74cc959dc6cfb31cfbbe9ce8abf32d1629e0f578f9199b9a2e90889a2f032919923142ab32e1dee0a53adafaefe0ebf2",
            "9e4d463d2e3dc2b98cba40ef84b022a76d01926d8de6ac05f995c07c5f07d01742c5410b240240459280d7d278e8bfec",
            "0d74c427ee654e4790c7118272998c131337d0d0555b68f488ac7cb8de3cfb461b0248e78340d74b828c80ca28adf478",
            "952f274ecbc66b68ea74cc8534a5d7edb219b755c91266e5a779ec22f52dd2efa9c447dd311e71c90e1419b4b2f3dae0",
            "b845b0a56afec2fb399559fa77c4835d2bc4c3f8d62beb1c45462bac661d2e553b43d0a86073f0ba5ab85b129ed20b1c",
            "e65b931e25101224a6933faae7dfcf22fe84759937f5f3bdaa90d9c8e8ecd0bfa1777b99a77e3232e38917f9432ccbfc",
            "4f69fe2cb97e9233bc873d153ed9d61b88c20fa333bd4137a532f4f703a323fac6f8675d8b44ef5fad2314894f7d60b6",
            "b36f43a6dd2917a1aa0c6b566599c274701bdf03a5b7dc65e5e9f0acf882786f07989b106a50d0d89629136ea0e26eb1",
            "8db7b80635c53daef891b777850487e72b67f57576eb05f708786f7665f1fdc2a78f441636569d1e84058a43f0243a1a",
            "14a43f1882ae0214f56819f4ae9276499d39db4a4a939275dddcddd80cb6b70999e6178c4ef295e69a807ee5fdbf9afd",
            "e5aa44cea67f0821d4ecbc981f258837a243fd901653d484be5c24eb7f08e0bf33525ee3ddf9a89e1263a853485b5a02",
            "0191f0505ce5512fa08500bdc090570f0c430161595894528fe7ae5dad8726e110b0676181a228a7a90e21b7b055361a",
            "76fa1230972e771661485546d6ce556fcda23b6dc0ffe94dd3bf7ff13fe9b46dcbc8d8ffc617f35687903b972fa7ea43",
            "fe280e1191d21cae12ea3b53d77e03ea4d96108d35555cbfa9b156253a011ed91b857b82d644bb94bac8e4fc4e0142b5",
            "beddc3c0e168a4b14b023dfc1ae07be9a418678494c2399695ea9b17843d373077a708f8c82f37657bdc101950fed664",
            "aa5d7ea1126bf16da2897ae036e94d1f96875ad306b19910efe3f17b7a98f9a4163e4032efd17ddbf78fe3321047509c"
        )

        var key = ByteArray(48) {
            it.toByte()
        }

        expectedOutput.forEachIndexed { index, output ->
            assertEquals(output, hash(key, ByteArray(index) { it.toByte() }))
            key = output.toBinary()
        }
    }
}
